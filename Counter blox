-- CuTins Heck HUB 2025 - MENU VISIBLE FIX
-- FIXED: Menu hi·ªÉn th·ªã ƒë·∫ßy ƒë·ªß t√≠nh nƒÉng

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- CONFIGURATION
local CuTins = {
    ACTIVE = true,
    VERSION = "CuTins FPS 2025",
    
    AIMBOT = {
        ENABLED = false,
        FOV = 80,
        SMOOTHING = 0.3,
        TEAM_CHECK = true,
        TRIGGERBOT = false
    },
    
    ESP = {
        ENABLED = false,
        TEAM_CHECK = true,
        BOX = true,
        NAMES = true
    },
    
    WEAPON = {
        NO_RECOIL = false,
        NO_SPREAD = false,
        RAPID_FIRE = false,
        INFINITE_AMMO = false
    },
    
    MOVEMENT = {
        SPEED = false,
        SPEED_VALUE = 30,
        JUMP = false,
        JUMP_VALUE = 75
    },
    
    VISUAL = {
        BRIGHT_MAP = false,
        CROSSHAIR = false
    }
}

-- VARIABLES
local TARGET = nil
local ESP_ITEMS = {}
local SCREEN_GUI = nil

-- ‚úÖ FIXED MENU CREATION - ƒê·∫¢M B·∫¢O HI·ªÇN TH·ªä ƒê·∫¶Y ƒê·ª¶
local function createFixedMenu()
    -- Cleanup old GUI
    if SCREEN_GUI then
        SCREEN_GUI:Destroy()
    end
    
    -- Create new GUI
    SCREEN_GUI = Instance.new("ScreenGui")
    SCREEN_GUI.Name = "CuTinsMenu"
    SCREEN_GUI.ResetOnSpawn = false
    SCREEN_GUI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    SCREEN_GUI.Parent = game:GetService("CoreGui")

    -- Main Container - ƒê·ª¶ L·ªöN ƒê·ªÇ HI·ªÇN TH·ªä T·∫§T C·∫¢
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 350, 0, 500)
    MainFrame.Position = UDim2.new(0.5, -175, 0.5, -250)
    MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 35)
    MainFrame.BorderSizePixel = 2
    MainFrame.BorderColor3 = Color3.fromRGB(255, 50, 50)
    MainFrame.Active = true
    MainFrame.Draggable = true
    MainFrame.ClipsDescendants = false -- QUAN TR·ªåNG: Cho ph√©p hi·ªÉn th·ªã ƒë·∫ßy ƒë·ªß
    MainFrame.Parent = SCREEN_GUI

    -- Title Bar
    local TitleBar = Instance.new("Frame")
    TitleBar.Size = UDim2.new(1, 0, 0, 40)
    TitleBar.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
    TitleBar.Parent = MainFrame

    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Size = UDim2.new(0.7, 0, 1, 0)
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Text = "CuTins FPS 2025"
    TitleLabel.TextColor3 = Color3.white
    TitleLabel.TextSize = 16
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.Parent = TitleBar

    local CloseButton = Instance.new("TextButton")
    CloseButton.Size = UDim2.new(0, 30, 0, 30)
    CloseButton.Position = UDim2.new(1, -35, 0.5, -15)
    CloseButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    CloseButton.Text = "X"
    CloseButton.TextColor3 = Color3.white
    CloseButton.TextSize = 14
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.Parent = TitleBar

    -- Content Area - SCROLLING FRAME ƒê·ª¶ L·ªöN
    local ContentFrame = Instance.new("ScrollingFrame")
    ContentFrame.Size = UDim2.new(1, -20, 1, -60) -- Chi·ªÅu cao ƒë·ªß l·ªõn
    ContentFrame.Position = UDim2.new(0, 10, 0, 50)
    ContentFrame.BackgroundTransparency = 1
    ContentFrame.ScrollBarThickness = 6
    ContentFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 150)
    ContentFrame.CanvasSize = UDim2.new(0, 0, 0, 800) -- QUAN TR·ªåNG: ƒê·ªß cho t·∫•t c·∫£ t√≠nh nƒÉng
    ContentFrame.Parent = MainFrame

    -- UIListLayout ƒë·ªÉ s·∫Øp x·∫øp c√°c n√∫t
    local UIListLayout = Instance.new("UIListLayout")
    UIListLayout.Padding = UDim2.new(0, 5)
    UIListLayout.Parent = ContentFrame

    -- ‚úÖ T·∫†O T·∫§T C·∫¢ T√çNH NƒÇNG - ƒê·∫¢M B·∫¢O HI·ªÇN TH·ªä ƒê·∫¶Y ƒê·ª¶

    -- SECTION: COMBAT
    createSection("‚öîÔ∏è COMBAT", ContentFrame)
    createFeatureToggle("Aimbot", "AIMBOT", "ENABLED", ContentFrame)
    createFeatureToggle("Team Check", "AIMBOT", "TEAM_CHECK", ContentFrame)
    createFeatureToggle("Triggerbot", "AIMBOT", "TRIGGERBOT", ContentFrame)
    createSlider("Aimbot FOV", "AIMBOT", "FOV", 10, 200, ContentFrame)
    createSlider("Smoothing", "AIMBOT", "SMOOTHING", 1, 100, ContentFrame, true)

    -- SECTION: VISUAL
    createSection("üëÅÔ∏è VISUAL", ContentFrame)
    createFeatureToggle("ESP", "ESP", "ENABLED", ContentFrame)
    createFeatureToggle("Team ESP", "ESP", "TEAM_CHECK", ContentFrame)
    createFeatureToggle("Box ESP", "ESP", "BOX", ContentFrame)
    createFeatureToggle("Show Names", "ESP", "NAMES", ContentFrame)

    -- SECTION: WEAPON
    createSection("üî´ WEAPON", ContentFrame)
    createFeatureToggle("No Recoil", "WEAPON", "NO_RECOIL", ContentFrame)
    createFeatureToggle("No Spread", "WEAPON", "NO_SPREAD", ContentFrame)
    createFeatureToggle("Rapid Fire", "WEAPON", "RAPID_FIRE", ContentFrame)
    createFeatureToggle("Infinite Ammo", "WEAPON", "INFINITE_AMMO", ContentFrame)

    -- SECTION: MOVEMENT
    createSection("üí® MOVEMENT", ContentFrame)
    createFeatureToggle("Speed Hack", "MOVEMENT", "SPEED", ContentFrame)
    createSlider("Speed Value", "MOVEMENT", "SPEED_VALUE", 16, 100, ContentFrame)
    createFeatureToggle("High Jump", "MOVEMENT", "JUMP", ContentFrame)
    createSlider("Jump Power", "MOVEMENT", "JUMP_VALUE", 50, 200, ContentFrame)

    -- SECTION: VISUAL ENHANCE
    createSection("üåü VISUAL ENHANCE", ContentFrame)
    createFeatureToggle("Bright Map", "VISUAL", "BRIGHT_MAP", ContentFrame)
    createFeatureToggle("Crosshair", "VISUAL", "CROSSHAIR", ContentFrame)

    -- Close button event
    CloseButton.MouseButton1Click:Connect(function()
        SCREEN_GUI.Enabled = false
    end)

    -- Auto-update canvas size khi th√™m elements
    UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        ContentFrame.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y + 10)
    end)

    return SCREEN_GUI
end

-- ‚úÖ FIXED UI COMPONENTS - ƒê·∫¢M B·∫¢O HI·ªÇN TH·ªä R√ï R√ÄNG

function createSection(title, parent)
    local section = Instance.new("Frame")
    section.Size = UDim2.new(1, 0, 0, 30)
    section.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
    section.BorderSizePixel = 0
    section.Parent = parent

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, -10, 1, 0)
    label.Position = UDim2.new(0, 10, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = title
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextSize = 14
    label.Font = Enum.Font.GothamBold
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = section

    return section
end

function createFeatureToggle(name, category, setting, parent)
    local toggleFrame = Instance.new("Frame")
    toggleFrame.Size = UDim2.new(1, 0, 0, 35)
    toggleFrame.BackgroundTransparency = 1
    toggleFrame.Parent = parent

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0.7, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = name
    label.TextColor3 = Color3.fromRGB(200, 200, 200)
    label.TextSize = 13
    label.Font = Enum.Font.Gotham
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = toggleFrame

    local toggleButton = Instance.new("TextButton")
    toggleButton.Size = UDim2.new(0, 60, 0, 25)
    toggleButton.Position = UDim2.new(1, -65, 0.5, -12.5)
    toggleButton.BackgroundColor3 = CuTins[category][setting] and Color3.fromRGB(0, 180, 0) or Color3.fromRGB(80, 80, 100)
    toggleButton.Text = CuTins[category][setting] and "ON" or "OFF"
    toggleButton.TextColor3 = Color3.white
    toggleButton.TextSize = 12
    toggleButton.Font = Enum.Font.GothamBold
    toggleButton.Parent = toggleFrame

    toggleButton.MouseButton1Click:Connect(function()
        CuTins[category][setting] = not CuTins[category][setting]
        toggleButton.BackgroundColor3 = CuTins[category][setting] and Color3.fromRGB(0, 180, 0) or Color3.fromRGB(80, 80, 100)
        toggleButton.Text = CuTins[category][setting] and "ON" or "OFF"
    end)

    return toggleFrame
end

function createSlider(name, category, setting, min, max, parent, isPercent)
    local sliderFrame = Instance.new("Frame")
    sliderFrame.Size = UDim2.new(1, 0, 0, 50)
    sliderFrame.BackgroundTransparency = 1
    sliderFrame.Parent = parent

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 0, 20)
    label.BackgroundTransparency = 1
    local displayValue = isPercent and math.floor(CuTins[category][setting] * 100) .. "%" or CuTins[category][setting]
    label.Text = name .. ": " .. displayValue
    label.TextColor3 = Color3.fromRGB(200, 200, 200)
    label.TextSize = 13
    label.Font = Enum.Font.Gotham
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = sliderFrame

    local track = Instance.new("Frame")
    track.Size = UDim2.new(1, 0, 0, 6)
    track.Position = UDim2.new(0, 0, 1, -25)
    track.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    track.Parent = sliderFrame

    local fill = Instance.new("Frame")
    local currentValue = isPercent and CuTins[category][setting] * 100 or CuTins[category][setting]
    fill.Size = UDim2.new((currentValue - min) / (max - min), 0, 1, 0)
    fill.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    fill.Parent = track

    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, 16, 0, 16)
    button.Position = UDim2.new((currentValue - min) / (max - min), -8, 0.5, -8)
    button.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    button.Text = ""
    button.Parent = track

    local dragging = false

    button.MouseButton1Down:Connect(function()
        dragging = true
    end)

    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local mousePos = UserInputService:GetMouseLocation()
            local trackAbsPos = track.AbsolutePosition
            local trackAbsSize = track.AbsoluteSize
            
            local relativeX = (mousePos.X - trackAbsPos.X) / trackAbsSize.X
            relativeX = math.clamp(relativeX, 0, 1)
            
            local newValue = math.floor(min + (relativeX * (max - min)))
            
            if isPercent then
                CuTins[category][setting] = newValue / 100
                label.Text = name .. ": " .. newValue .. "%"
            else
                CuTins[category][setting] = newValue
                label.Text = name .. ": " .. newValue
            end
            
            fill.Size = UDim2.new(relativeX, 0, 1, 0)
            button.Position = UDim2.new(relativeX, -8, 0.5, -8)
        end
    end)

    return sliderFrame
end

-- ‚úÖ GAME FUNCTIONS (GI·ªÆ NGUY√äN)

local function getClosestPlayer()
    if not CuTins.AIMBOT.ENABLED then return nil end
    
    local closest = nil
    local closestDist = CuTins.AIMBOT.FOV
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            if CuTins.AIMBOT.TEAM_CHECK and player.Team and LocalPlayer.Team and player.Team == LocalPlayer.Team then
                continue
            end
            
            local root = player.Character:FindFirstChild("HumanoidRootPart")
            if root then
                local screenPos, onScreen = Camera:WorldToViewportPoint(root.Position)
                if onScreen then
                    local mousePos = UserInputService:GetMouseLocation()
                    local distance = (Vector2.new(screenPos.X, screenPos.Y) - mousePos).Magnitude
                    if distance < closestDist then
                        closestDist = distance
                        closest = player
                    end
                end
            end
        end
    end
    return closest
end

local function updateESP()
    -- Cleanup
    for player, highlight in pairs(ESP_ITEMS) do
        if highlight then highlight:Destroy() end
    end
    ESP_ITEMS = {}
    
    if not CuTins.ESP.ENABLED then return end
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            if CuTins.ESP.TEAM_CHECK and player.Team and LocalPlayer.Team and player.Team == LocalPlayer.Team then
                continue
            end
            
            local highlight = Instance.new("Highlight")
            highlight.FillColor = Color3.fromRGB(255, 50, 50)
            highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
            highlight.FillTransparency = 0.8
            highlight.Adornee = player.Character
            highlight.Parent = player.Character
            
            ESP_ITEMS[player] = highlight
        end
    end
end

-- ‚úÖ MAIN LOOP

RunService.Heartbeat:Connect(function()
    -- Aimbot
    if CuTins.AIMBOT.ENABLED and TARGET then
        local targetPart = TARGET.Character:FindFirstChild("Head") or TARGET.Character:FindFirstChild("HumanoidRootPart")
        if targetPart then
            local currentCF = Camera.CFrame
            local targetPos = targetPart.Position
            local direction = (targetPos - currentCF.Position).Unit
            local smoothDirection = currentCF.LookVector:Lerp(direction, CuTins.AIMBOT.SMOOTHING)
            Camera.CFrame = CFrame.new(currentCF.Position, currentCF.Position + smoothDirection)
        end
    end
    
    -- ESP
    updateESP()
    
    -- Movement
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        local humanoid = LocalPlayer.Character.Humanoid
        humanoid.WalkSpeed = CuTins.MOVEMENT.SPEED and CuTins.MOVEMENT.SPEED_VALUE or 16
        humanoid.JumpPower = CuTins.MOVEMENT.JUMP and CuTins.MOVEMENT.JUMP_VALUE or 50
    end
    
    -- Triggerbot
    if CuTins.AIMBOT.TRIGGERBOT and CuTins.AIMBOT.ENABLED then
        local target = getClosestPlayer()
        if target then
            wait(0.1)
            mouse1click()
        end
    end
end)

-- ‚úÖ INPUT HANDLING

UserInputService.InputBegan:Connect(function(input, processed)
    if processed then return end
    
    if input.UserInputType == Enum.UserInputType.MouseButton1 and CuTins.AIMBOT.ENABLED then
        TARGET = getClosestPlayer()
    end
    
    -- Toggle menu v·ªõi Insert key
    if input.KeyCode == Enum.KeyCode.Insert then
        if SCREEN_GUI then
            SCREEN_GUI.Enabled = not SCREEN_GUI.Enabled
        else
            createFixedMenu()
        end
    end
end)

UserInputService.InputEnded:Connect(function(input, processed)
    if processed then return end
    
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        TARGET = nil
    end
end)

-- ‚úÖ INITIALIZE

createFixedMenu()

print([[
 
 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà      ‚ñà‚ñà    ‚ñà‚ñà    ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà
‚ñà‚ñà      ‚ñà‚ñà    ‚ñà‚ñà    ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà  ‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà‚ñà      ‚ñà‚ñà    ‚ñà‚ñà    ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà  ‚ñà‚ñà ‚ñà‚ñà     ‚ñà‚ñà
 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     ‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
                                                 
        Menu Hack - CuTins ¬© 2025

‚úÖ MENU ƒê√É HI·ªÇN TH·ªä ƒê·∫¶Y ƒê·ª¶ T√çNH NƒÇNG!

]])

-- Auto cleanup
game:GetService("Players").PlayerRemoving:Connect(function(player)
    if player == LocalPlayer and SCREEN_GUI then
        SCREEN_GUI:Destroy()
    end
end)
